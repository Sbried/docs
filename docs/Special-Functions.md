Some entities mapped in MQTT are generated by EMS-ESP and not read from the EMS bus.

`heating_active` and `tapwater_active` are calculated from the burner and valve/pump settings. These are used by both the Shower Timer and Energy Measurement features.

## Shower Timer

Measures the time hot water is running with burner on. This works only for dhw flow systems; in buffered dhw systems the time is always the charge time of the buffer.
As an additional feature, there is the Shower Alert, which alerts and triggers a burst of cold water after a configured time. The coldshot is managed by the entity `boiler/tapactivated`, and uses a custom function that sets the boiler into its 'testmode', enables tapwater flow but disables the burner.

## Force Heating Off

Some users control the boiler without a thermostat and want to switch the boiler off when a desired temperature is reached. Sending `boiler/selflowtemp 0` to the boiler has to be repeated every minute otherwise the boiler will fall back to the selected temperature on the panel.

The function `boiler/forceheatingoff` repeats this command every minute, so the heating remains off. In the EMS-ESP settings it is possible to set the poweron-value of `forceheatingoff`.

## Energy Measurement

For gas and oil burners, Bosch does not measure the energy consumption. EMS-ESP calculates the consumption of each boiler message by burner modulation and nominal boiler power. Some gas boilers have the nominal power stored, some do not.
Also the stored power is not always correct, a boiler of same type could be equipped with different burners or have its burners adjusted by air/nozzle size.
In these cases, the nominal power `boiler/nonpower` can be changed and stored in EMS-ESP. Check the setting before using the energy values.

## Remote Thermostats

Modern thermostats mainly use outdoor temperature to calculate the flow temperature. A single thermostat placed on the boiler can do this for different heating circuits. This type of control is slow.

If you change the target room temperature, the thermostat calculates the flow temp to reach and hold this temperature.
A room thermostat could measure that the actual temperture is much lower and raise the flowtemp much higher until the temperature is reached. This is called outdoorcontrolled with room influence and needs a remote thermostat in the room. In `thermostat/hcx/control` the remote has to be set.

EMS-ESP can emulate a remote thermostat and send a temperature as a measured room temperature to the master-thermostat.
The original remote thermostats can also change the dhw settings, the setpoint, etc. In EMS-ESP this could set on the master.

With `thermostat/hcx/remotetemp` and a valid temperature the function is started. EMS-ESP now sends the value with origin of a remote roomthermostat, thus emulating a remote thermostat.

For the master thermostat RC30/RC35 a RC20 is emulated, for RC3x0/BC400 you have to choose the control first to RC200 or RC100H, EMS-ESP then emulates the selected room thermostat.
For Junkers/Bosch FW120 and similar an FB10 is emulated and has to be selected for emulation.

To activate this function, follow these steps:

- set `thermostat/hcx/control` to the right Remote
- send `thermostat/hcx/remotetemp` with your measured temperature
- for RC100H send `thermostat/hcx/remotehum` with a value
- EMS-ESP will find a new thermostat with entities for room temperature and humidity
- update the remote values on change, there is no need for periodic sending as this is done by EMS-ESP

and to stop the function:

- send `thermostat/hcx/remotetemp` with value `-1`
- set `thermostat/hcx/control` to the master thermostst (RC35/RC300/FW120, etc.)
- the remote thermostat in the EMS-ESP device list stays, but has no entities

If the control is set to roomthermostat and the first remotetemp is not set within a minute, the master will show an error message.

## Schedule

The `schedule` function can be used to permanently maintain the remote thermostat. The thermostat is recreated and provided with starting values ​​every time the EMS-ESP is restarted.

![EMS-SCHEDULE-EDIT](https://github.com/emsesp/docs/assets/80219712/d1009d40-7d80-41a8-9690-d3222d9a0612)

- `Timer 00:00` for trigger once on start-up
- `Command` is `thermostat/hcx/remotetemp` or/and `thermostat/hcx/remotehum` for RC100H
- `Value` is a typical tempetature for your home
- `Name` is freely selectable

![EMS-SCHEDULE-MAIN](https://github.com/emsesp/docs/assets/80219712/bc0487fe-a214-4c56-a454-1870c27a9de9)

In the overview it should look like this for the RC100H example.
